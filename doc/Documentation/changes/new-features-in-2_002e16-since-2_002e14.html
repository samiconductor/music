<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created on January 1, 2014 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>LilyPond Changes: 1.2 New features in 2.16 since 2.14</title>

<meta name="description" content="LilyPond Changes: 1.2 New features in 2.16 since 2.14">
<meta name="keywords" content="LilyPond Changes: 1.2 New features in 2.16 since 2.14">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="LilyPond Changes">
<link href="index_abt.html#SEC_About" rel="help" title="About This Document">
<link href="index.html#index" rel="up" title="1. New features in 2.16">
<link href="fixes-and-changes-after-2_002e16_002e0.html#fixes-and-changes-after-2_002e16_002e0" rel="previous" title="1.1 Fixes and changes after 2.16.0">
<link rel="stylesheet" type="text/css" title="Default style" href="../../Documentation/css/lilypond-manuals.css">
<!--[if lte IE 7]>
<link href="../../Documentation/css/lilypond-ie-fixes.css" rel="stylesheet" type="text/css">
<![endif]-->


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">


<div id="main">
<a name="New-features-in-2_002e16-since-2_002e14"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="index.html" title="Beginning of this chapter or previous chapter"> &lt;&lt; Top&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.html#Top" title="Cover (top) of document" rel="start">Top</a>][Contents][Index][<a href="index_abt.html#SEC_About" title="About (help)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[&nbsp; &gt;&gt; ]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="fixes-and-changes-after-2_002e16_002e0.html" title="Previous section in reading order" accesskey="p" rel="previous"> &lt; Fixes and changes after 2.16.0&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="index.html" title="Up section" accesskey="u" rel="up">&nbsp; Up :&nbsp;Top&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[&nbsp; &gt; ]</td></tr></table>
<a name="new-features-in-2_002e16-since-2_002e14"></a>
<h2 class="section">1.2 New features in 2.16 since 2.14</h2>
<ul>
<li>
Support for cross-staff stems on chords, using <code>crossStaff</code>
and the <code>Span_stem_engraver</code>.  This calculates the length of
cross-staff stems automatically.
<blockquote><p>
 <a href="../2b/lily-a719ac2f.ly">
  <img align="middle"
       border="0"
       src="../2b/lily-a719ac2f.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
The syntax of words (character sequences recognized without enclosing
quotes) and commands (now always a backslash &lsquo;<samp>\</samp>&rsquo; followed by a
word) has been unified across all modes: it now consists of alphabetic
characters, possibly enclosing isolated dashes &lsquo;<samp>-</samp>&rsquo; and underlines
&lsquo;<samp>_</samp>&rsquo;.

<p>As one consequence, using unquoted text scripts like (literally!)
</p><blockquote><pre class="example">{ c-script c\f_script }
</pre></blockquote>
<p>will now tend to result in invalid music.  Omitting quote marks
for arbitrary text rather than keywords has never been good practice or
even documented, and it is unlikely to have seen significant use.
</p>
<p>Staying with established conventions (like not using dashes or
underlines for command names intended to be used inside of music)
remains advisable.  The reason for this change is more robust
recognition of LilyPond&rsquo;s lexical units for LilyPond itself as well as
external tools interpreting its syntax.
</p>
</li><li>
Support for Kievan square notation:
<blockquote><pre class="verbatim">\new KievanVoice {
  \cadenzaOn
  c d e f g a bes
  \bar &quot;kievan&quot;
}
</pre><p>
 <a href="../0f/lily-0d2fdffb.ly">
  <img align="middle"
       border="0"
       src="../0f/lily-0d2fdffb.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
Augmentation dots now avoid the other voice in two-voice polyphony
so that users can move the <code>Dot_column_engraver</code> to set dots
independently for each <code>Voice</code>.
<blockquote><p>
 <a href="../e9/lily-e3ff1f4b.ly">
  <img align="middle"
       border="0"
       src="../e9/lily-e3ff1f4b.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
A Scheme function to adjust the control points of curves such as slurs
and ties, developed by several users, is now included in LilyPond.
<blockquote><pre class="verbatim">g8-&gt;( bes,-.) d4
\shape Slur #'((-0.5 . 1.5) (-3 . 0) (0 . 0) (0 . 0))
g8-&gt;( bes,!-.) d4
</pre><p>
 <a href="../61/lily-1564b6f0.ly">
  <img align="middle"
       border="0"
       src="../61/lily-1564b6f0.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
Use of <code>\tempo</code> specifications in <code>\midi</code> blocks (removed in
2.9.16 in favor of explicit <code>tempoWholesPerMinute</code> settings) has
seen a revival: now any kind of property-setting music is turned into
context definitions within output specifications, allowing for
declarations like
<blockquote><pre class="example">\layout { \accidentalStyle modern }
\midi { \tempo 4. = 66 }
</pre></blockquote>

</li><li>
The LilyPond G clef has been redesigned - upper loop is now more balanced,
bottom crook sticks out less and the &quot;spine&quot; (main vertical line) is more
evenly curved. The old and new versions can be compared by looking at the
documentation:
<a href="http://lilypond.org/doc/v2.14/Documentation/notation/the-feta-font.html#clef-glyphs">old version</a>,
<a href="http://lilypond.org/doc/v2.15/Documentation/notation/the-feta-font.html#clef-glyphs">new version</a>.

</li><li>
Lilypond&rsquo;s stencil commands have been simplified to allow for less code
duplication and better height approximations of graphical objects.  The
following stencil commands have been eliminated:
<ul>
<li> <code>beam</code>
</li><li> <code>bezier-sandwich</code>
</li><li> <code>bracket</code>
</li><li> <code>dashed-slur</code>
</li><li> <code>dot</code>
</li><li> <code>oval</code>
</li><li> <code>repeat-slash</code>
</li><li> <code>zigzag-line</code>
</li></ul>

</li><li>
Flags are now treated as separate objects rather than as stem parts.
<blockquote><p>
 <a href="../91/lily-8274d73f.ly">
  <img align="middle"
       border="0"
       src="../91/lily-8274d73f.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
Two alternative methods for bar numbering can be set, especially for
when using repeated music;

<blockquote><p>
 <a href="../e2/lily-5375b5c4.ly">
  <img align="middle"
       border="0"
       src="../e2/lily-5375b5c4.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
The following is a fundamental change in LilyPond&rsquo;s music
representation: Rhythmic events like <code>LyricEvent</code> and
<code>NoteEvent</code> are no longer wrapped in <code>EventChord</code> unless they
have been actually entered as part of a chord in the input.  If you
manipulate music expressions in Scheme, the new behavior may require
changes in your code.  Calling the music function <code>\eventChords</code> or
the Scheme function <code>event-chord-wrap!</code>  converts to the old
representation; using one of those might be easiest for keeping legacy
code operative.

<p>The following three items are consequences of this change.
</p>
</li><li>
The repetitive chord entry aid <code>q</code> has been reimplemented.
Repeated chords are now replaced right before interpreting a music
expression.  In case the user wants to retain some events of the
original chord, he can run the repeat chord replacement function
<code>\chordRepeats</code> manually.

</li><li>
String numbers and right hand fingerings on single notes now appear
without having to be written inside of chord brackets.

</li><li>
Music functions now work the same when used inside or outside of chords,
including all the possibilities of argument parsing.  Music variables
can be used inside of chords: a construct like
<blockquote><pre class="verbatim">tonic=fis'
{ &lt;\tonic \transpose c g \tonic&gt; }
</pre><p>
 <a href="../b0/lily-3f26ee93.ly">
  <img align="middle"
       border="0"
       src="../b0/lily-3f26ee93.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>


<p>now works as expected.  One can use <code>#{&hellip;#}</code> for
constructing chord constituents.  <code>\tweak</code> now works on single
notes without needing to wrap them in a chord.  Using it on command
events and lyrics is now possible, but not likely to give results yet.
</p>
</li><li>
<code>\tweak</code> now takes an optional layout object specification.  It can
be used for tweaking layout objects that are only indirectly caused by
the tweaked event, like accidentals, stems, and flags:

<blockquote><pre class="verbatim">&lt;\tweak Accidental #'color #red   cis4
 \tweak Accidental #'color #green es
                                  g&gt;
</pre><p>
 <a href="../82/lily-9e2fad63.ly">
  <img align="middle"
       border="0"
       src="../82/lily-9e2fad63.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
Scheme expressions inside of embedded Lilypond (<code>#{&hellip;#}</code>)
are now executed in lexical closure of the surrounding Scheme code.
<code>$</code> is no longer special in embedded Lilypond.  It can be used
unconditionally in Lilypond code for immediate evaluation of Scheme
expressions, similar to how <code>ly:export</code> could previously be used.
<code>ly:export</code> has been removed.  As a consequence, <code>#</code> is now
free to delay evaluation of its argument until the parser actually
reduces the containing expression, greatly reducing the potential for
premature evaluation.  There are also &lsquo;splicing&rsquo; operators <code>$@</code>
and <code>#@</code> for interpreting the members of a list individually.

</li><li>
To reduce the necessity for using <code>$</code>, Scheme expressions written
with <code>#</code> are interpreted as music inside of music lists, and as
markups or markup lists inside of markups.

</li><li>
Support for jazz-like chords has been improved: Lydian and altered
chords are recognised; separators between chord modifiers are now
treated independently of separators between &ldquo;slash&rdquo; chords and their
bass notes (and by default, slashes are now only used for the latter
type of separator); additional pitches are no longer prefixed with
&ldquo;add&rdquo; by default; and the &ldquo;m&rdquo; in minor chords can be customized.
<a name="index-Customizing-chord-names"></a>
<a href="../notation/displaying-chords.html#customizing-chord-names">Customizing chord names</a> for more information.

</li><li>
The <code>\markuplines</code> command has been renamed to <code>\markuplist</code>
for a better match with its semantics and general Lilypond
nomenclature.

</li><li>
The interface for specifying string tunings in tablature has been
simplified considerably and employs the scheme function
<code>\stringTuning</code> for most purposes.

</li><li>
Beams can now have their slopes preserved over line breaks.
<blockquote><p>
 <a href="../93/lily-3d3cc815.ly">
  <img align="middle"
       border="0"
       src="../93/lily-3d3cc815.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>


<p>To do this, several callback functions are now deprecated.
</p><ul>
<li> <code>ly:beam::calc-least-squares-positions</code>
</li><li> <code>ly:beam::slope-damping</code>
</li><li> <code>ly:beam::shift-region-to-valid</code>
</li></ul>
<p>Furthermore, <code>ly:beam::quanting</code> now takes an additional argument
to help calculations over line breaks.  All of these functions are now
automatically called when setting the <code>positions</code> parameter.
</p>
</li><li>
In function arguments music, markups and Scheme expressions (as well as
several other syntactic entities) have become mostly interchangeable and
are told apart only by evaluating the respective predicate.  In several
cases, the predicate is consulted by the parser, like when deciding
whether to interpret <code>-3</code> as a number or a fingering event.

</li><li>
Music functions (and their close relatives) can now be defined with
optional arguments.

</li><li>
For defining commands executed only for their side-effects,
<code>define-void-function</code> is now available.

</li><li>
There is a new <code>define-event-function</code> command in analogy to
<code>define-music-function</code> that can be used for defining music
functions acting as post events without requiring a direction specifier
(<code>-</code>, <code>^</code>, or <code>_</code>) placed before them.
<blockquote><pre class="verbatim">dyn=#(define-event-function (parser location arg) (markup?)
         (make-dynamic-script arg))
\relative c' { c\dyn pfsss }
</pre><p>
 <a href="../29/lily-d56aaba3.ly">
  <img align="middle"
       border="0"
       src="../29/lily-d56aaba3.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
A list of ASCII aliases for special characters can be included.
<blockquote><pre class="verbatim">\paper {
  #(include-special-characters)
}
\markup &quot;&amp;bull; &amp;dagger; &amp;copyright; &amp;OE; &amp;ss; &amp;para;&quot;
</pre><p>
 <a href="../f0/lily-d3014dfa.ly">
  <img align="middle"
       border="0"
       src="../f0/lily-d3014dfa.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
There is a new <code>define-scheme-function</code> command in analogy to
<code>define-music-function</code> that can be used to define functions
evaluating to Scheme expressions while accepting arguments in Lilypond
syntax.

</li><li>
The construct <code>#{ &hellip; #}</code> can now be used not just for
constructing sequential music lists, but also for pitches (distinguished
from single note events by the absence of a duration or other
information that can&rsquo;t be part of a pitch), single music events, void
music expressions, post events, markups (mostly freeing users from
having to use the <code>markup</code> macro), markup lists, number
expressions, context definitions and modifications, and a few other
things.  If it encloses nothing or only a single music event, it no
longer returns a sequential music list but rather a void music
expression or just the music event itself, respectively.

</li><li>
Pitches can be used on the right side of assignments.  They are
distinguished from single note events by the absence of a duration or
other information that can&rsquo;t be part of a pitch.

</li><li>
New command-line option &lsquo;<samp>--loglevel=<var>level</var></samp>&rsquo; to control how much output
LilyPond creates. Possible values are ERROR, WARN, BASIC_PROGRESS, PROGRESS, DEBUG.

</li><li>
<code>\once \set</code> now correctly resets the property value to the previous value.
<blockquote><p>
 <a href="../bf/lily-6d93e262.ly">
  <img align="middle"
       border="0"
       src="../bf/lily-6d93e262.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
The alignment of dynamic spanners (hairpins, text crescendo, etc.) is now
automatically broken if a different direction is explicitly given.
<blockquote><p>
 <a href="../ed/lily-1bf9e4c0.ly">
  <img align="middle"
       border="0"
       src="../ed/lily-1bf9e4c0.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




</li><li>
Appoggiaturas and acciaccaturas now also work inside a slur, not only inside
a phrasing slur. Also, a function <code>\slashedGrace</code> was added that does
not use a slur from the acciaccatura note.
<blockquote><p>
 <a href="../5a/lily-7cd8a41b.ly">
  <img align="middle"
       border="0"
       src="../5a/lily-7cd8a41b.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




</li><li>
To suppress the line on a crescendo text spanner (and other similar spanners),
LilyPond now fully supports the <code>#'style = #'none</code> property.
<blockquote><p>
 <a href="../4a/lily-79661051.ly">
  <img align="middle"
       border="0"
       src="../4a/lily-79661051.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



</li><li>
LilyPond.app now supports MacOS X 10.7, thanks Christian Hitz!

</li><li>
Glissandi can now span multiple lines.

</li></ul>

<p>For older news, go to
<a href="http://lilypond.org/doc/v2.14/Documentation/changes">http://lilypond.org/doc/v2.14/Documentation/changes/</a>,
<a href="http://lilypond.org/doc/v2.12/Documentation/topdocs/NEWS.html">http://lilypond.org/doc/v2.12/Documentation/topdocs/NEWS.html</a>,
or <a href="..">go back</a> to the Documentation index.
</p>


<hr size="6">
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="index.html" title="Beginning of this chapter or previous chapter"> &lt;&lt; Top&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.html#Top" title="Cover (top) of document" rel="start">Top</a>][Contents][Index][<a href="index_abt.html#SEC_About" title="About (help)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[&nbsp; &gt;&gt; ]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="fixes-and-changes-after-2_002e16_002e0.html" title="Previous section in reading order" accesskey="p" rel="previous"> &lt; Fixes and changes after 2.16.0&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="index.html" title="Up section" accesskey="u" rel="up">&nbsp; Up :&nbsp;Top&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[&nbsp; &gt; ]</td></tr></table>
<!-- footer_tag -->
<div class="footer">
<!-- This footer was autogenerated by /build/buildd/lilypond-2.16.2/scripts/build/out/www_post -->
<p class="footer_version">
This page is for LilyPond-2.16.2 (stable-branch).
</p>
<p class="footer_report">
We welcome your aid; please <a href="http://lilypond.org/help-us.html">help us</a> by reporting errors to our <a href="http://post.gmane.org/post.php?group=gmane.comp.gnu.lilypond.bugs">bug list</a>.
</p>
</div>


<!-- FOOTER -->

<!-- end div#main here -->
</div>



<div id="tocframe">
<p class="toc_uplink"><a href="../../Documentation/web/manuals.html"
         title="Documentation Index">&lt;&lt; Back to Documentation Index</a></p>
<h4 class="toc_header"> <a href="index.html#Top" title="Start of the manual">LilyPond Changes</a></h4>
<div class="contents">
<ul class="toc">
    <li class=""><a name="toc-Fixes-and-changes-after-2_002e16_002e0-1" href="fixes-and-changes-after-2_002e16_002e0.html">1.1 Fixes and changes after 2.16.0</a>    </li>
    <li class=" toc_current"><a name="toc-New-features-in-2_002e16-since-2_002e14-1" href="new-features-in-2_002e16-since-2_002e14.html">1.2 New features in 2.16 since 2.14</a>    </li>
<li>
<!--
we depend on an external entity here, which we cannot control.  Suppose
we go from 2.16.x to 2.17.x and put the documentation under "v2.17".
For some time, Google won't have the new location in its index, so the
search would get nothing.  It would be better to keep "v2.16" in the
search for a while and have a redirection from "v2.16" to "v2.17".
-->

<form action="http://google.com/search"
      method="get"
      name="search"
      onSubmit="search.q.value='site:lilypond.org/doc/v2.16 '
		+ search.brute_query.value"
      onMouseMove="search.q.value='site:lilypond.org/doc/v2.16 '
		   + search.brute_query.value"
      onKeyUp="search.q.value='site:lilypond.org/doc/v2.16 '
	       + search.brute_query.value">
  <input type="hidden" name="btnG" value="Google Search">
  <input type="text" name="brute_query" onfocus="this.value=''" value="Search">
  <input type="hidden" name="q" value="">
</form>
</li>
</ul>
</div>
</div>

</body>
</html>
