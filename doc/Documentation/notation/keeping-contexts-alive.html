<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright C 1999-2012 by the authors.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.1
or any later version published by the Free Software Foundation;
with no Invariant Sections.
A copy of the license is included in the section entitled "GNU
Free Documentation License".

 -->
<!-- Created on January 1, 2014 by texi2html 1.82
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>LilyPond Notation Reference: 5.1.3 Keeping contexts alive</title>

<meta name="description" content="LilyPond Notation Reference: 5.1.3 Keeping contexts alive">
<meta name="keywords" content="LilyPond Notation Reference: 5.1.3 Keeping contexts alive">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.82">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#index" rel="start" title="LilyPond &mdash; Notation Reference">
<link href="lilypond-command-index.html#lilypond-command-index" rel="index" title="E. LilyPond command index">
<link href="index_toc.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="index_abt.html#SEC_About" rel="help" title="About This Document">
<link href="interpretation-contexts.html#interpretation-contexts" rel="up" title="5.1 Interpretation contexts">
<link href="lilypond-index.html#lilypond-index" rel="next" title="F. LilyPond index">
<link href="creating-contexts.html#creating-contexts" rel="previous" title="5.1.2 Creating contexts">
<link rel="stylesheet" type="text/css" title="Default style" href="../../Documentation/css/lilypond-manuals.css">
<!--[if lte IE 7]>
<link href="../../Documentation/css/lilypond-ie-fixes.css" rel="stylesheet" type="text/css">
<![endif]-->


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">


<div id="main">
<a name="Keeping-contexts-alive"></a>
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="changing-defaults.html" title="Beginning of this chapter or previous chapter"> &lt;&lt; Changing defaults&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.html" title="Cover (top) of document" rel="start">Top</a>][<a href="index_toc.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="lilypond-command-index.html" title="Index" rel="index">Index</a>][<a href="index_abt.html#SEC_About" title="About (help)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="notation-manual-tables.html" title="Next chapter">&nbsp;Notation manual tables &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="creating-contexts.html" title="Previous section in reading order" accesskey="p" rel="previous"> &lt; Creating contexts&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="interpretation-contexts.html" title="Up section" accesskey="u" rel="up">&nbsp; Up :&nbsp;Interpretation contexts&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="modifying-context-plug_002dins.html" title="Next section in reading order" accesskey="n" rel="next">&nbsp;Modifying context plug-ins &gt; </a>]</td></tr></table>
<a name="keeping-contexts-alive"></a>
<h3 class="subsection">5.1.3 Keeping contexts alive</h3>

<a name="index-contexts_002c-keeping-alive"></a>
<a name="index-contexts_002c-lifetime"></a>

<p>Contexts are usually terminated at the first musical moment in
which they have nothing to do.  So <code>Voice</code> contexts die as
soon as they contain no events; <code>Staff</code> contexts die as soon
as all the <code>Voice</code> contexts within them contain no events; etc.
This can cause difficulties if earlier contexts which have died
have to be referenced, for example, when changing staves with
<code>\change</code> commands, associating lyrics with a voice with
<code>\lyricsto</code> commands, or when adding further musical events to
an earlier context.
</p>
<p>There is an exception to this general rule: just one of the
<code>Voice</code> contexts in a <code>Staff</code> context or in a
<code>&lt;&lt;...&gt;&gt;</code> construct will always persist to the end of the
enclosing <code>Staff</code> context or <code>&lt;&lt;...&gt;&gt;</code> construct, even
though there may be periods when it has nothing to do.  The context
to persist in this way will be the first one encountered in the
first enclosed <code>{...}</code> construct, ignoring any in enclosed
<code>&lt;&lt;...&gt;&gt;</code> constructs.
</p>
<p>Any context can be kept alive by ensuring it has something to do at
every musical moment.  <code>Staff</code> contexts are kept alive by
ensuring one of their voices is kept alive.  One way of doing this
is to add spacer rests to a voice in parallel with the real music.
These need to be added to every <code>Voice</code> context which needs to
be kept alive.  If several voices are to be used sporadically it is
safest to keep them all alive rather than attempting to rely on the
exceptions mentioned above.
</p>
<p>In the following example, both voice A and voice B are kept alive
in this way for the duration of the piece:
</p>
<blockquote><pre class="verbatim">musicA = \relative c'' { d4 d d d }
musicB = \relative c'' { g4 g g g }
keepVoicesAlive = {
  &lt;&lt;
    \new Voice = &quot;A&quot; { s1*5 }  % Keep Voice &quot;A&quot; alive for 5 bars
    \new Voice = &quot;B&quot; { s1*5 }  % Keep Voice &quot;B&quot; alive for 5 bars
  &gt;&gt;
}

music = {
  \context Voice = &quot;A&quot; {
    \voiceOneStyle
    \musicA
  }
  \context Voice = &quot;B&quot; {
    \voiceTwoStyle
    \musicB
  }
  \context Voice = &quot;A&quot; { \musicA }
  \context Voice = &quot;B&quot; { \musicB }
  \context Voice = &quot;A&quot; { \musicA }
}

\score {
  \new Staff &lt;&lt;
    \keepVoicesAlive
    \music
  &gt;&gt;
}
</pre><p>
 <a href="../8f/lily-84f7c135.ly">
  <img align="middle"
       border="0"
       src="../8f/lily-84f7c135.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<a name="index-lyrics_002c-aligning-with-sporadic-melody"></a>

<p>The following example shows how a sporadic melody line with lyrics
might be written using this approach.  In a real situation the
melody and accompaniment would consist of several different
sections, of course.
</p>
<blockquote><pre class="verbatim">melody = \relative c'' { a4 a a a }
accompaniment = \relative c' { d4 d d d }
words = \lyricmode { These words fol -- low the mel -- o -- dy }
\score {
  &lt;&lt;
    \new Staff = &quot;music&quot; {
      &lt;&lt;
        \new Voice = &quot;melody&quot; {
          \voiceOne
          s1*4  % Keep Voice &quot;melody&quot; alive for 4 bars
        }
        {
          \new Voice = &quot;accompaniment&quot; {
            \voiceTwo
            \accompaniment
          }
          &lt;&lt;
            \context Voice = &quot;melody&quot; { \melody }
            \context Voice = &quot;accompaniment&quot; { \accompaniment }
          &gt;&gt;
          \context Voice = &quot;accompaniment&quot; { \accompaniment }
          &lt;&lt;
            \context Voice = &quot;melody&quot; { \melody }
            \context Voice = &quot;accompaniment&quot; { \accompaniment }
          &gt;&gt;
        }
      &gt;&gt;
    }
    \new Lyrics \with { alignAboveContext = #&quot;music&quot; }
    \lyricsto &quot;melody&quot; { \words }
  &gt;&gt;
}
</pre><p>
 <a href="../0f/lily-23cd483c.ly">
  <img align="middle"
       border="0"
       src="../0f/lily-23cd483c.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>



<p>An alternative way, which may be better in many circumstances, is
to keep the melody line alive by simply including spacer notes to
line it up correctly with the accompaniment:
</p>
<blockquote><pre class="verbatim">melody = \relative c'' {
  s1  % skip a bar
  a4 a a a
  s1  % skip a bar
  a4 a a a
}
accompaniment = \relative c' {
  d4 d d d
  d4 d d d
  d4 d d d
  d4 d d d
}
words = \lyricmode { These words fol -- low the mel -- o -- dy }

\score {
  &lt;&lt;
    \new Staff = &quot;music&quot; {
      &lt;&lt;
        \new Voice = &quot;melody&quot; {
          \voiceOne
          \melody
        }
        \new Voice = &quot;accompaniment&quot; {
          \voiceTwo
          \accompaniment
        }
      &gt;&gt;
    }
    \new Lyrics \with { alignAboveContext = #&quot;music&quot; }
    \lyricsto &quot;melody&quot; { \words }
  &gt;&gt;
}
</pre><p>
 <a href="../43/lily-073fa645.ly">
  <img align="middle"
       border="0"
       src="../43/lily-073fa645.png"
       alt="[image of music]">
 </a>
</p>
</blockquote>




<hr size="6">
<table class="nav_table">
<tr><td valign="middle" align="left" colspan="1">[<a href="changing-defaults.html" title="Beginning of this chapter or previous chapter"> &lt;&lt; Changing defaults&nbsp;</a>]</td><td valign="middle" align="center" colspan="3">[<a href="index.html" title="Cover (top) of document" rel="start">Top</a>][<a href="index_toc.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="lilypond-command-index.html" title="Index" rel="index">Index</a>][<a href="index_abt.html#SEC_About" title="About (help)" rel="help"> ? </a>]</td><td valign="middle" align="right" colspan="1">[<a href="notation-manual-tables.html" title="Next chapter">&nbsp;Notation manual tables &gt;&gt; </a>]</td></tr><tr><td valign="middle" align="left" colspan="2">[<a href="creating-contexts.html" title="Previous section in reading order" accesskey="p" rel="previous"> &lt; Creating contexts&nbsp;</a>]</td><td valign="middle" align="center" colspan="1">[<a href="interpretation-contexts.html" title="Up section" accesskey="u" rel="up">&nbsp; Up :&nbsp;Interpretation contexts&nbsp;</a>]</td><td valign="middle" align="right" colspan="2">[<a href="modifying-context-plug_002dins.html" title="Next section in reading order" accesskey="n" rel="next">&nbsp;Modifying context plug-ins &gt; </a>]</td></tr></table>
<!-- footer_tag -->
<div class="footer">
<!-- This footer was autogenerated by /build/buildd/lilypond-2.16.2/scripts/build/out/www_post -->
<p class="footer_version">
This page is for LilyPond-2.16.2 (stable-branch).
</p>
<p class="footer_report">
We welcome your aid; please <a href="http://lilypond.org/help-us.html">help us</a> by reporting errors to our <a href="http://post.gmane.org/post.php?group=gmane.comp.gnu.lilypond.bugs">bug list</a>.
</p>
</div>


<p id="languages">
<!-- These links were autogenerated by /build/buildd/lilypond-2.16.2/scripts/build/out/www_post -->
 Other languages: <a href="keeping-contexts-alive.de.html">deutsch</a>, <a href="keeping-contexts-alive.es.html">español</a>, <a href="keeping-contexts-alive.fr.html">français</a>, <a href="keeping-contexts-alive.it.html">italiano</a>, <a href="keeping-contexts-alive.ja.html">日本語</a>.
 <br>
 About <a href="http://www.lilypond.org/website/misc/browser-language">automatic language selection</a>.
</p>

<!-- FOOTER -->

<!-- end div#main here -->
</div>



<div id="tocframe">
<p class="toc_uplink"><a href="../../Documentation/web/manuals.html"
         title="Documentation Index">&lt;&lt; Back to Documentation Index</a></p>
<h4 class="toc_header"> <a href="index.html" title="Start of the manual">LilyPond &mdash; Notation Reference</a></h4>
<div class="contents">
<ul class="toc">
  <li class=""><a name="toc-Musical-notation-1" href="musical-notation.html">1. Musical notation</a>
  <ul class="toc">
    <li class=""><a name="toc-Pitches-1" href="pitches.html">1.1 Pitches</a>    </li>
    <li class=""><a name="toc-Rhythms-1" href="rhythms.html">1.2 Rhythms</a>    </li>
    <li class=""><a name="toc-Expressive-marks-1" href="expressive-marks.html">1.3 Expressive marks</a>    </li>
    <li class=""><a name="toc-Repeats-1" href="repeats.html">1.4 Repeats</a>    </li>
    <li class=""><a name="toc-Simultaneous-notes-1" href="simultaneous-notes.html">1.5 Simultaneous notes</a>    </li>
    <li class=""><a name="toc-Staff-notation-1" href="staff-notation.html">1.6 Staff notation</a>    </li>
    <li class=""><a name="toc-Editorial-annotations-1" href="editorial-annotations.html">1.7 Editorial annotations</a>    </li>
    <li class=""><a name="toc-Text-1" href="text.html">1.8 Text</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-Specialist-notation-1" href="specialist-notation.html">2. Specialist notation</a>
  <ul class="toc">
    <li class=""><a name="toc-Vocal-music-1" href="vocal-music.html">2.1 Vocal music</a>    </li>
    <li class=""><a name="toc-Keyboard-and-other-multi_002dstaff-instruments-1" href="keyboard-and-other-multi_002dstaff-instruments.html">2.2 Keyboard and other multi-staff instruments</a>    </li>
    <li class=""><a name="toc-Unfretted-string-instruments-1" href="unfretted-string-instruments.html">2.3 Unfretted string instruments</a>    </li>
    <li class=""><a name="toc-Fretted-string-instruments-1" href="fretted-string-instruments.html">2.4 Fretted string instruments</a>    </li>
    <li class=""><a name="toc-Percussion-1" href="percussion.html">2.5 Percussion</a>    </li>
    <li class=""><a name="toc-Wind-instruments-1" href="wind-instruments.html">2.6 Wind instruments</a>    </li>
    <li class=""><a name="toc-Chord-notation-1" href="chord-notation.html">2.7 Chord notation</a>    </li>
    <li class=""><a name="toc-Contemporary-music-1" href="contemporary-music.html">2.8 Contemporary music</a>    </li>
    <li class=""><a name="toc-Ancient-notation-1" href="ancient-notation.html">2.9 Ancient notation</a>    </li>
    <li class=""><a name="toc-World-music-1" href="world-music.html">2.10 World music</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-General-input-and-output-1" href="general-input-and-output.html">3. General input and output</a>
  <ul class="toc">
    <li class=""><a name="toc-Input-structure-1" href="input-structure.html">3.1 Input structure</a>    </li>
    <li class=""><a name="toc-Titles-and-headers-1" href="titles-and-headers.html">3.2 Titles and headers</a>    </li>
    <li class=""><a name="toc-Working-with-input-files-1" href="working-with-input-files.html">3.3 Working with input files</a>    </li>
    <li class=""><a name="toc-Controlling-output-1" href="controlling-output.html">3.4 Controlling output</a>    </li>
    <li class=""><a name="toc-MIDI-output-1" href="midi-output.html">3.5 MIDI output</a>    </li>
    <li class=""><a name="toc-Extracting-musical-information-1" href="extracting-musical-information.html">3.6 Extracting musical information</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-Spacing-issues-1" href="spacing-issues.html">4. Spacing issues</a>
  <ul class="toc">
    <li class=""><a name="toc-Page-layout-1" href="page-layout.html">4.1 Page layout</a>    </li>
    <li class=""><a name="toc-Score-layout-1" href="score-layout.html">4.2 Score layout</a>    </li>
    <li class=""><a name="toc-Breaks-1" href="breaks.html">4.3 Breaks</a>    </li>
    <li class=""><a name="toc-Vertical-spacing-1" href="vertical-spacing.html">4.4 Vertical spacing</a>    </li>
    <li class=""><a name="toc-Horizontal-spacing-1" href="horizontal-spacing.html">4.5 Horizontal spacing</a>    </li>
    <li class=""><a name="toc-Fitting-music-onto-fewer-pages-1" href="fitting-music-onto-fewer-pages.html">4.6 Fitting music onto fewer pages</a>    </li>
  </ul>
  </li>
  <li class=" toc_current"><a name="toc-Changing-defaults-1" href="changing-defaults.html">5. Changing defaults</a>
  <ul class="toc">
    <li class=" toc_current"><a name="toc-Interpretation-contexts-1" href="interpretation-contexts.html">5.1 Interpretation contexts</a>
    <ul class="toc">
      <li class=""><a name="toc-Contexts-explained-1" href="contexts-explained.html">5.1.1 Contexts explained</a>      </li>
      <li class=""><a name="toc-Creating-contexts-1" href="creating-contexts.html">5.1.2 Creating contexts</a>      </li>
      <li class=" toc_current"><a name="toc-Keeping-contexts-alive-1" href="keeping-contexts-alive.html">5.1.3 Keeping contexts alive</a>      </li>
      <li class=""><a name="toc-Modifying-context-plug_002dins-1" href="modifying-context-plug_002dins.html">5.1.4 Modifying context plug-ins</a>      </li>
      <li class=""><a name="toc-Changing-context-default-settings-1" href="changing-context-default-settings.html">5.1.5 Changing context default settings</a>      </li>
      <li class=""><a name="toc-Defining-new-contexts-1" href="defining-new-contexts.html">5.1.6 Defining new contexts</a>      </li>
      <li class=""><a name="toc-Context-layout-order-1" href="context-layout-order.html">5.1.7 Context layout order</a>      </li>
    </ul>
    </li>
    <li class=""><a name="toc-Explaining-the-Internals-Reference-1" href="explaining-the-internals-reference.html">5.2 Explaining the Internals Reference</a>    </li>
    <li class=""><a name="toc-Modifying-properties-1" href="modifying-properties.html">5.3 Modifying properties</a>    </li>
    <li class=""><a name="toc-Useful-concepts-and-properties-1" href="useful-concepts-and-properties.html">5.4 Useful concepts and properties</a>    </li>
    <li class=""><a name="toc-Advanced-tweaks-1" href="advanced-tweaks.html">5.5 Advanced tweaks</a>    </li>
    <li class=""><a name="toc-Using-music-functions-1" href="using-music-functions.html">5.6 Using music functions</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-Notation-manual-tables-1" href="notation-manual-tables.html">A. Notation manual tables</a>
  <ul class="toc">
    <li class=""><a name="toc-Chord-name-chart-1" href="chord-name-chart.html">A.1 Chord name chart</a>    </li>
    <li class=""><a name="toc-Common-chord-modifiers-1" href="common-chord-modifiers.html">A.2 Common chord modifiers</a>    </li>
    <li class=""><a name="toc-Predefined-string-tunings-1" href="predefined-string-tunings.html">A.3 Predefined string tunings</a>    </li>
    <li class=""><a name="toc-Predefined-fretboard-diagrams-1" href="predefined-fretboard-diagrams.html">A.4 Predefined fretboard diagrams</a>    </li>
    <li class=""><a name="toc-Predefined-paper-sizes-1" href="predefined-paper-sizes.html">A.5 Predefined paper sizes</a>    </li>
    <li class=""><a name="toc-MIDI-instruments-1" href="midi-instruments.html">A.6 MIDI instruments</a>    </li>
    <li class=""><a name="toc-List-of-colors-1" href="list-of-colors.html">A.7 List of colors</a>    </li>
    <li class=""><a name="toc-The-Feta-font-1" href="the-feta-font.html">A.8 The Feta font</a>    </li>
    <li class=""><a name="toc-Note-head-styles-1" href="note-head-styles.html">A.9 Note head styles</a>    </li>
    <li class=""><a name="toc-Text-markup-commands-1" href="text-markup-commands.html">A.10 Text markup commands</a>    </li>
    <li class=""><a name="toc-Text-markup-list-commands-1" href="text-markup-list-commands.html">A.11 Text markup list commands</a>    </li>
    <li class=""><a name="toc-List-of-special-characters-1" href="list-of-special-characters.html">A.12 List of special characters</a>    </li>
    <li class=""><a name="toc-List-of-articulations-1" href="list-of-articulations.html">A.13 List of articulations</a>    </li>
    <li class=""><a name="toc-Percussion-notes-1" href="percussion-notes.html">A.14 Percussion notes</a>    </li>
    <li class=""><a name="toc-Technical-glossary-1" href="technical-glossary.html">A.15 Technical glossary</a>    </li>
    <li class=""><a name="toc-All-context-properties-1" href="all-context-properties.html">A.16 All context properties</a>    </li>
    <li class=""><a name="toc-Layout-properties-1" href="layout-properties.html">A.17 Layout properties</a>    </li>
    <li class=""><a name="toc-Available-music-functions-1" href="available-music-functions.html">A.18 Available music functions</a>    </li>
    <li class=""><a name="toc-Context-modification-identifiers-1" href="context-modification-identifiers.html">A.19 Context modification identifiers</a>    </li>
    <li class=""><a name="toc-Predefined-type-predicates-1" href="predefined-type-predicates.html">A.20 Predefined type predicates</a>    </li>
    <li class=""><a name="toc-Scheme-functions-1" href="scheme-functions.html">A.21 Scheme functions</a>    </li>
  </ul>
  </li>
  <li class=""><a name="toc-Cheat-sheet-1" href="cheat-sheet.html">B. Cheat sheet</a>  </li>
  <li class=""><a name="toc-LilyPond-grammar-1" href="lilypond-grammar.html">C. LilyPond grammar</a>  </li>
  <li class=""><a name="toc-GNU-Free-Documentation-License-1" href="gnu-free-documentation-license.html">D. GNU Free Documentation License</a>  </li>
  <li class=""><a name="toc-LilyPond-command-index-1" href="lilypond-command-index.html">E. LilyPond command index</a>  </li>
  <li class=""><a name="toc-LilyPond-index-1" href="lilypond-index.html">F. LilyPond index</a>  </li>
<li>
<!--
we depend on an external entity here, which we cannot control.  Suppose
we go from 2.16.x to 2.17.x and put the documentation under "v2.17".
For some time, Google won't have the new location in its index, so the
search would get nothing.  It would be better to keep "v2.16" in the
search for a while and have a redirection from "v2.16" to "v2.17".
-->

<form action="http://google.com/search"
      method="get"
      name="search"
      onSubmit="search.q.value='site:lilypond.org/doc/v2.16 '
		+ search.brute_query.value"
      onMouseMove="search.q.value='site:lilypond.org/doc/v2.16 '
		   + search.brute_query.value"
      onKeyUp="search.q.value='site:lilypond.org/doc/v2.16 '
	       + search.brute_query.value">
  <input type="hidden" name="btnG" value="Google Search">
  <input type="text" name="brute_query" onfocus="this.value=''" value="Search">
  <input type="hidden" name="q" value="">
</form>
</li>
</ul>
</div>
</div>

</body>
</html>
